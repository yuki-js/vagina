# コーディングルール整理タスク - Issue #88

## 概要
スクリーンとコンポーネントのディレクトリ構成を適切に整理し、コーディングルールを遵守する。

## 現状の課題
現在、`lib/screens/`ディレクトリ内に多数のコンポーネント（再利用可能な小さなウィジェット）が配置されており、
本来`lib/components/`に配置すべきファイルが混在している。

## ディレクトリ構成の原則
- **`lib/screens/`**: フルページのビュー（画面）のみを配置
  - `*_screen.dart`: 独立した画面
  - `*_page.dart`: PageViewやTabBarで使用されるページ
  - `*_flow.dart`: 画面遷移フロー
  - `*_tab.dart`: タブサーフェス（画面として扱ってOK）

- **`lib/components/`**: 再利用可能な小さなウィジェット
  - 複数の画面で使用される可能性のあるUI部品
  - 画面の一部を構成するウィジェット

## 移動が必要なファイル

### チャット関連コンポーネント
```
lib/screens/chat/chat_bubble.dart -> lib/components/chat_bubble.dart
lib/screens/chat/chat_input.dart -> lib/components/chat_input.dart  
lib/screens/chat/tool_details_sheet.dart -> lib/components/tool_details_sheet.dart
```

### 通話関連コンポーネント
```
lib/screens/call/control_panel.dart -> lib/components/control_panel.dart
```

### ノートパッド関連コンポーネント
```
lib/screens/notepad/notepad_action_bar.dart -> lib/components/notepad_action_bar.dart
lib/screens/notepad/notepad_content_renderer.dart -> lib/components/notepad_content_renderer.dart
lib/screens/notepad/notepad_edit_button.dart -> lib/components/notepad_edit_button.dart
lib/screens/notepad/notepad_empty_state.dart -> lib/components/notepad_empty_state.dart
lib/screens/notepad/notepad_html_content.dart -> lib/components/notepad_html_content.dart
lib/screens/notepad/notepad_markdown_content.dart -> lib/components/notepad_markdown_content.dart
lib/screens/notepad/notepad_plain_text_content.dart -> lib/components/notepad_plain_text_content.dart
```

### 設定セクションコンポーネント
新しいディレクトリ `lib/components/settings/` を作成し、以下を移動：
```
lib/screens/settings/about_section.dart -> lib/components/settings/about_section.dart
lib/screens/settings/android_audio_section.dart -> lib/components/settings/android_audio_section.dart
lib/screens/settings/azure_config_section.dart -> lib/components/settings/azure_config_section.dart
lib/screens/settings/developer_section.dart -> lib/components/settings/developer_section.dart
lib/screens/settings/pip_settings_section.dart -> lib/components/settings/pip_settings_section.dart
lib/screens/settings/ui_preferences_section.dart -> lib/components/settings/ui_preferences_section.dart
lib/screens/settings/voice_settings_section.dart -> lib/components/settings/voice_settings_section.dart
```

## 作業手順

### ステップ1: 新しいディレクトリの作成
```bash
mkdir -p lib/components/settings
```

### ステップ2: ファイルの移動
Gitを使用してファイルを移動（履歴を保持するため）:
```bash
# チャット関連
git mv lib/screens/chat/chat_bubble.dart lib/components/chat_bubble.dart
git mv lib/screens/chat/chat_input.dart lib/components/chat_input.dart
git mv lib/screens/chat/tool_details_sheet.dart lib/components/tool_details_sheet.dart

# 通話関連
git mv lib/screens/call/control_panel.dart lib/components/control_panel.dart

# ノートパッド関連
git mv lib/screens/notepad/notepad_action_bar.dart lib/components/notepad_action_bar.dart
git mv lib/screens/notepad/notepad_content_renderer.dart lib/components/notepad_content_renderer.dart
git mv lib/screens/notepad/notepad_edit_button.dart lib/components/notepad_edit_button.dart
git mv lib/screens/notepad/notepad_empty_state.dart lib/components/notepad_empty_state.dart
git mv lib/screens/notepad/notepad_html_content.dart lib/components/notepad_html_content.dart
git mv lib/screens/notepad/notepad_markdown_content.dart lib/components/notepad_markdown_content.dart
git mv lib/screens/notepad/notepad_plain_text_content.dart lib/components/notepad_plain_text_content.dart

# 設定セクション
git mv lib/screens/settings/about_section.dart lib/components/settings/about_section.dart
git mv lib/screens/settings/android_audio_section.dart lib/components/settings/android_audio_section.dart
git mv lib/screens/settings/azure_config_section.dart lib/components/settings/azure_config_section.dart
git mv lib/screens/settings/developer_section.dart lib/components/settings/developer_section.dart
git mv lib/screens/settings/pip_settings_section.dart lib/components/settings/pip_settings_section.dart
git mv lib/screens/settings/ui_preferences_section.dart lib/components/settings/ui_preferences_section.dart
git mv lib/screens/settings/voice_settings_section.dart lib/components/settings/voice_settings_section.dart
```

### ステップ3: インポートパスの更新
各ファイル内のインポートパスを更新する必要があります。例：
- `../../components/xxx.dart` → `../../components/xxx.dart` （変更なしまたは調整）
- `../../screens/xxx/yyy.dart` → 適切なパスに更新

**更新が必要なファイル:**
- 移動したファイル自身（相対パスの調整）
- 移動したファイルをインポートしている全てのファイル

### ステップ4: インポート更新の自動化
以下のコマンドで影響を受けるファイルを特定：
```bash
# chat_bubble.dartを使用しているファイルを検索
grep -r "chat_bubble.dart" lib/ --include="*.dart"

# すべての移動ファイルについて同様に実行
```

### ステップ5: テストとビルド確認
```bash
# 解析
flutter analyze --no-fatal-infos

# テスト
flutter test

# ビルド（各プラットフォーム）
flutter build apk --debug  # Android
flutter build windows --debug  # Windows
flutter build ios --debug --no-codesign  # iOS
```

### ステップ6: コミット
```bash
git add .
git commit -m "Refactor: Reorganize screens and components according to coding rules (Issue #88)"
```

## 注意事項
- この作業は影響範囲が大きいため、段階的に進めることを推奨
- 各ステップでテストを実行し、問題がないことを確認
- インポートパスの更新漏れがないよう注意

## 完了条件
- [ ] すべてのコンポーネントが適切なディレクトリに配置されている
- [ ] すべてのインポートパスが正しく更新されている
- [ ] `flutter analyze --no-fatal-infos` がエラーなく完了する
- [ ] `flutter test` がすべてパスする
- [ ] 各プラットフォームでビルドが成功する
