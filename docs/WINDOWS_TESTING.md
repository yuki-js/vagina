# Windows テスト手順

このドキュメントは Windows 版のローカルテストとスクリーンショット撮影の手順を説明します。

## 前提条件

Windows 10 または 11 の実機環境が必要です。

## テスト手順

### 1. 環境構築

```powershell
# Flutter のバージョン確認
flutter --version
# 出力: Flutter 3.27.1 以降

# Windows デスクトップサポートの有効化
flutter config --enable-windows-desktop

# 依存関係のインストール
flutter pub get
```

### 2. デバッグビルドの実行

```powershell
# デバッグモードで起動
flutter run -d windows

# または、ビルドして実行
flutter build windows --debug
.\build\windows\x64\runner\Debug\vagina.exe
```

### 3. テスト項目

#### 基本機能

- [ ] アプリケーションが起動する
- [ ] UI が正しく表示される
- [ ] 日本語フォント（Noto Sans JP）が正しく表示される
- [ ] ウィンドウのリサイズが正常に動作する
- [ ] ウィンドウの最小化・最大化が正常に動作する

#### マイク機能

- [ ] マイクの権限要求ダイアログが表示される
- [ ] 権限を許可した後、マイクが使用できる
- [ ] 音声入力が正常に動作する（波形表示など）
- [ ] 録音の開始・停止が正常に動作する

#### ネットワーク機能

- [ ] 設定画面が開ける
- [ ] API キーの入力・保存が正常に動作する
- [ ] Azure OpenAI Realtime API への接続が成功する
- [ ] WebSocket 接続が安定している

#### 音声出力

- [ ] AI からの音声応答が再生される
- [ ] 音声の音量調整が可能
- [ ] 音声再生中の視覚フィードバックが表示される

#### その他

- [ ] アプリケーションの終了が正常に動作する
- [ ] クラッシュやフリーズが発生しない
- [ ] メモリリークがない（長時間使用時）
- [ ] CPU 使用率が適切

### 4. スクリーンショットの撮影

以下の画面のスクリーンショットを撮影してください：

#### 必須

1. **起動画面**
   - アプリケーション起動直後の画面
   - ファイル名: `01_startup.png`

2. **メイン画面（待機中）**
   - 音声入力待機状態の画面
   - ファイル名: `02_main_idle.png`

3. **音声入力中**
   - マイクボタンを押して音声入力している状態
   - ファイル名: `03_recording.png`

4. **会話履歴**
   - AI との会話が表示されている画面
   - ファイル名: `04_conversation.png`

5. **設定画面**
   - 設定画面を開いた状態
   - APIキーは伏せ字にする
   - ファイル名: `05_settings.png`

#### オプション

6. **エラー画面**
   - エラーダイアログが表示されている状態（もしあれば）
   - ファイル名: `06_error.png`

7. **権限要求ダイアログ**
   - マイク権限の要求ダイアログ（初回起動時）
   - ファイル名: `07_permission_dialog.png`

### 5. スクリーンショット撮影方法

#### Windows の Snipping Tool を使用

```
Win + Shift + S
```

または

```
スタートメニュー → Snipping Tool
```

#### 保存場所

スクリーンショットは `docs/screenshots/windows/` に保存してください：

```
docs/
└── screenshots/
    └── windows/
        ├── 01_startup.png
        ├── 02_main_idle.png
        ├── 03_recording.png
        ├── 04_conversation.png
        ├── 05_settings.png
        ├── 06_error.png (optional)
        └── 07_permission_dialog.png (optional)
```

## リリースビルドのテスト

デバッグビルドでの動作確認が完了したら、リリースビルドもテストしてください：

```powershell
# リリースビルド
flutter build windows --release

# 実行
.\build\windows\x64\runner\Release\vagina.exe
```

リリースビルドでは以下を確認：

- [ ] デバッグビルドと同じ動作をする
- [ ] パフォーマンスが向上している
- [ ] ファイルサイズが適切
- [ ] 配布用の ZIP ファイルが正しく作成できる

## トラブルシューティング

### マイクが動作しない

1. Windows の設定でマイクの権限を確認
   - 設定 → プライバシー → マイク
2. アプリケーションがマイクにアクセスできるようになっているか確認

### ビルドエラー

Visual Studio の C++ ツールがインストールされているか確認：

```powershell
flutter doctor -v
```

### 音声が再生されない

1. Windows のサウンド設定を確認
2. 音量ミキサーでアプリケーションの音量を確認

## CI/CD での確認

GitHub Actions でビルドされたバイナリをダウンロードしてテストすることもできます：

1. [Actions タブ](https://github.com/yuki-js/vagina/actions) を開く
2. "Windows CI" ワークフローから成功したビルドを選択
3. Artifacts から ZIP ファイルをダウンロード
4. 解凍して実行

## レポート

テスト完了後、以下の情報を含むレポートを作成してください：

### テスト環境

- OS バージョン: (例: Windows 11 23H2)
- Flutter バージョン: (例: 3.27.1)
- テスト日時:

### テスト結果

各テスト項目の結果を記載：

```
✓ アプリケーションが起動する
✓ UI が正しく表示される
✗ 音声入力が正常に動作しない（エラー内容）
...
```

### スクリーンショット

撮影したスクリーンショットのリストと場所

### 発見された問題

問題があれば詳細を記載：
- 現象
- 再現手順
- 期待される動作
- 実際の動作

### 総合評価

- [ ] 本番環境で使用可能
- [ ] 軽微な問題あり（使用可能）
- [ ] 重大な問題あり（修正必要）

## 注意事項

- **セキュリティ**: スクリーンショットに API キーやその他の機密情報が写り込まないように注意
- **プライバシー**: 個人情報が含まれる可能性のある会話内容は、サンプルデータを使用
- **Windows Defender**: 初回実行時に SmartScreen の警告が表示される可能性があります（正常）
